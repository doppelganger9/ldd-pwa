<!DOCTYPE html>
<html lang="en">
    <head>
        <title>My Simple Site</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#f0f">

        <link rel="icon" type="images/png" sizes="216x216" href="favicons/favicon-216.png">
        <link rel="apple-touch-icon" type="images/png" sizes="216x216" href="favicons/favicon-216.png">

        <meta name="Description" content="Lighthouse Driven Development Progressive Web Application">
        <link rel="manifest" href="/manifest.webmanifest">
        <script>
         if('serviceWorker' in navigator) {
           navigator.serviceWorker
                    .register('/sw.js')
                    .then(function(registration) { console.log("Service Worker Registered with scope: " + registration.scope); })
                    .catch(function(error) { console.log("Service Worker Registration failed with error: "+ error); });
         }
         </script>
        <script>
// and here's the trick (works everywhere)
function r(f) { /in/.test(document.readyState) ? setTimeout('r(' + f + ')', 9) : f() }
// use like
r(function () {
    // VanillaJS FTW!
    var body = document.querySelector('body')
    appendTo(body, 'h1', 'Hello World')
    appendTo(body, 'h2', 'TODO');
    appendTodoTo(body, true, 'Run Lighthouse Audit');
    appendTo(body, 'h3', 'Changes on the website');
    appendTodoTo(body, true, 'add noscript');
    appendTodoTo(body, true, 'add Service Worker (to handle offline)');
    appendTodoTo(body, true, 'add Manifest');
    appendTodoTo(body, true, 'add meta name="viewport"');
    appendTodoTo(body, true, 'add meta name="theme-color"');
    appendTodoTo(body, true, 'HTML doctype');
    appendTo(body, 'h3', 'changes on the server side');
    appendTodoTo(body, true, 'serve with HTTPS');
    appendTodoTo(body, true, 'redirect HTTP to HTTPS');
    appendTodoTo(body, true, 'serve with HTTP/2');
    appendTo(body, 'h3', 'Optional : CI/CD with Lighthouse running as a bot to check PRs');
    appendTodoTo(body, true, 'integration with Travis-CI');
    appendTodoTo(body, true, 'deploy to Firebase Hosting');
    appendTodoTo(body, false, 'show current version: {{REPLACE_THIS_WITH_COMMIT_HASH}}');
    appendTodoTo(body, false, 'add Lighthouse CI check on PRs');
    appendTodoTo(body, true, 'replace Travis-CI with GitHub Actions');
});
function appendTo(root, tagName, text) {
    var tag = document.createElement(tagName);
    tag.appendChild(document.createTextNode(text));
    root.appendChild(tag);
}
function appendTodoTo(root, checked, labelText) {
    var input = document.createElement('input');
    input.type='checkbox';
    input.id='todo_' + generateUID();
    checked && (input.checked='checked');
    var label = document.createElement('label');
    label.htmlFor = input.id;
    label.appendChild(document.createTextNode(labelText));
    var br = document.createElement('br');
    root.appendChild(input);
    root.appendChild(label);
    root.appendChild(br);
}
// https://stackoverflow.com/a/6248722/526660
function generateUID() {
    // I generate the UID from two parts here
    // to ensure the random number provide enough bits.
    var firstPart = (Math.random() * 46656) | 0;
    var secondPart = (Math.random() * 46656) | 0;
    firstPart = ("000" + firstPart.toString(36)).slice(-3);
    secondPart = ("000" + secondPart.toString(36)).slice(-3);
    return firstPart + secondPart;
}
        </script>
    </head>
    <body>
      <noscript>JavaScript is required for this application to work.</noscript>
    </body>
</html>
